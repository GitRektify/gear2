<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>PlaniPet Service</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
    <button class="settings-button btn" onclick="toggleSettings()">‚öôÔ∏è Settings</button>

    <div class="settings-panel" id="settingsPanel">
        <h3>Settings</h3>
        <div class="toggle-switch">
            
        </div>
    </div>

    <h1>PlaniPet Service</h1>

    <form method="POST" enctype="multipart/form-data">
        <div class="file-upload">
            <label for="file-input" class="file-label">üìÇ Choose File</label>
            <input type="file" name="file" id="file-input" onchange="showFileNameAndButton()" />
            <div class="file-name" id="file-name" style="display: none;"></div>
            <input type="submit" value="Import" class="btn" id="import-btn" style="display: none;" />
        </div>
    </form>

    <h2>Service List</h2>
    <!-- Service List Dynamic Content (e.g. using a templating engine like Jinja or your server-side logic) -->
    {% if items %}
    <table>
        <thead>
            <tr>
                <th>Ville</th>
                <th>Quartier</th>
                <th>Metier</th>
                <th>Animal</th>
                <th>Specificite</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {% for item in items %}
            <tr>
                <td>{{ item['ville'] }}</td>
                <td>{{ item['quartier'] }}</td>
                <td>{{ item['metier'] }}</td>
                <td>{{ item['animal'] }}</td>
                <td>{{ item['specificite'] }}</td>
                <td>
                    <form method="GET" action="/item/{{ loop.index0 }}">
                        <button class="btn" type="submit">Open</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p>No valid items found in the CSV.</p>
    {% endif %}

    <script>
        function showFileNameAndButton() {
            const fileInput = document.getElementById("file-input");
            const fileName = document.getElementById("file-name");
            const importBtn = document.getElementById("import-btn");

            if (fileInput.files.length > 0) {
                fileName.textContent = fileInput.files[0].name;
                fileName.style.display = "block";
                importBtn.style.display = "inline-block";
            } else {
                fileName.style.display = "none";
                importBtn.style.display = "none";
            }
        }

        function toggleSettings() {
            const panel = document.getElementById("settingsPanel");
            panel.style.display = panel.style.display === "block" ? "none" : "block";
        }

        window.onload = function () {
            const darkModeSetting = localStorage.getItem("darkMode");
            const toggle = document.getElementById("darkModeToggle");
            if (darkModeSetting === "enabled" || darkModeSetting === null) {
                document.body.classList.add("dark-mode");  // Default to dark mode
                toggle.checked = true;
            } else {
                document.body.classList.remove("dark-mode");
                toggle.checked = false;
            }
        };
    </script>
</body>

</html>
